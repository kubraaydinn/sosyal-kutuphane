{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <div class="row">
    <!-- Sol: Popüler Kullanıcılar + Arama -->
    <div class="col-md-3 mb-3">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title mb-3">Popüler Kullanıcılar</h5>

          <form method="get" class="mb-3">
            <div class="input-group input-group-sm">
              <input type="text"
                     name="user_q"
                     class="form-control"
                     placeholder="Kullanıcı ara..."
                     value="{{ user_q }}">
              <button class="btn btn-outline-secondary">Ara</button>
            </div>
          </form>

          <div class="list-group list-group-flush small">
            {% for u, follower_count in popular_users %}
              <a href="{{ url_for('profile.view_profile', username=u.username) }}"
                 class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                <span>{{ u.username }}</span>
                <span class="text-muted">{{ follower_count }} takipçi</span>
              </a>
            {% else %}
              <p class="text-muted mb-0">Kullanıcı bulunamadı.</p>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>

    <!-- Sağ: Aktivite kartları (2 sütun) -->
    <div class="col-md-9">
      <h3 class="mb-3">Kullanıcı Aktiviteleri</h3>

      <div id="activity-grid" class="row row-cols-1 row-cols-md-2 g-3">
        {% include "feed/_activity_cards.html" %}
      </div>

      <div class="text-center mt-3 mb-4" id="load-more-container">
        {% if has_next %}
          <button id="load-more-activities"
                  class="btn btn-outline-primary"
                  data-next-page="{{ next_page }}"
                  data-url="{{ url_for('feed.more') }}">
            Daha Fazla Yükle
          </button>
        {% else %}
          <small class="text-muted">Tüm aktiviteler yüklendi.</small>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
